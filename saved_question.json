{"difficulty": "hard", "Question": "Given two Pandas DataFrames, `transactions_df` and `products_df`, perform the following analysis:\n\n1.  **Merge Data**: Combine `transactions_df` with `products_df` to include product category information in the transactions.\n2.  **Calculate Monthly Category Revenue per Customer**: For each `customer_id` and `category`, calculate their total monthly revenue. Ensure dates are handled correctly (e.g., convert 'purchase_date' to datetime and extract year-month).\n3.  **Identify Last Month's Top Category**: For each `customer_id`, determine which `category` generated the highest revenue in the *latest month available* across the entire dataset. If a customer has no transactions in the last month, their 'last_month_top_category' should be `None` or `NaN`.\n4.  **Calculate Overall Top Category**: For each `customer_id`, determine which `category` generated the highest total revenue across *all available time*. In case of a tie in total revenue for a customer across categories, any of the tied categories can be chosen.\n5.  **Assess Category Shift**: Create a new DataFrame that, for each `customer_id`, shows their `last_month_top_category`, `overall_top_category`, and a boolean `has_shifted` indicating if `last_month_top_category` is different from `overall_top_category`. Consider `None`/`NaN` in `last_month_top_category` as a shift if `overall_top_category` exists.\n\nThe final output should be a DataFrame with `customer_id` as the index and columns `last_month_top_category`, `overall_top_category`, and `has_shifted`.", "Input": "Two Pandas DataFrames:\n1.  `transactions_df`: Contains `transaction_id` (int), `customer_id` (int), `product_id` (int), `purchase_date` (str, 'YYYY-MM-DD'), `price` (float), `quantity` (int).\n2.  `products_df`: Contains `product_id` (int), `product_name` (str), `category` (str), `subcategory` (str).", "Output": "A Pandas DataFrame with `customer_id` as the index and the following columns:\n-   `last_month_top_category` (str or None/NaN): The category that generated the highest revenue for the customer in the latest month of data. If no transactions in the last month, this should be `None` or `NaN`.\n-   `overall_top_category` (str): The category that generated the highest revenue for the customer across all time.\n-   `has_shifted` (bool): True if `last_month_top_category` is different from `overall_top_category` (or if `last_month_top_category` is None/NaN and `overall_top_category` exists), False otherwise."}